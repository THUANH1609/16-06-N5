<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="view_van_ban_tree" model="ir.ui.view">
            <field name="name">van_ban.tree</field>
            <field name="model">quan_ly_van_ban</field>
            <field name="arch" type="xml">
                <tree string="Danh sách văn bản" 
                      decoration-info="trang_thai in ['cho_duyet', 'dang_xu_ly']" 
                      decoration-success="trang_thai in ['da_ky', 'hoan_tat']"
                      decoration-muted="trang_thai == 'huy'">
                    <field name="so_hieu"/>
                    <field name="ten_van_ban" string="Trích yếu nội dung"/>
                    <field name="luong_van_ban" string="Loại" widget="badge" 
                           decoration-info="luong_van_ban == 'den'" 
                           decoration-warning="luong_van_ban == 'di'"/>
                    <field name="hinh_thuc_van_ban" string="Thể loại" widget="badge"/>
                    <field name="ngay_ban_hanh"/>
                    <field name="nhan_vien_id" string="Người phụ trách"/>
                    <field name="trang_thai" widget="badge" 
                           decoration-success="trang_thai in ['da_ky', 'hoan_tat']" 
                           decoration-warning="trang_thai in ['cho_duyet', 'dang_xu_ly']"
                           decoration-danger="trang_thai == 'huy'"/>
                </tree>
            </field>
        </record>

        <record id="view_van_ban_search" model="ir.ui.view">
            <field name="name">quan_ly_van_ban.search</field>
            <field name="model">quan_ly_van_ban</field>
            <field name="arch" type="xml">
                <search>
                    <field name="ten_van_ban" string="Nội dung/Số hiệu" 
                           filter_domain="['|', ('ten_van_ban', 'ilike', self), ('so_hieu', 'ilike', self)]"/>
                    <field name="nhan_vien_id"/>
                    <field name="khach_hang_id"/>
                    <separator/>
                    <filter string="Văn bản ĐẾN" name="den" domain="[('luong_van_ban', '=', 'den')]"/>
                    <filter string="Văn bản ĐI" name="di" domain="[('luong_van_ban', '=', 'di')]"/>
                    <separator/>
                    <filter string="Chờ duyệt/Đang xử lý" name="processing" 
                            domain="[('trang_thai', 'in', ['cho_duyet', 'dang_xu_ly'])]"/>
                    <group expand="0" string="Gom nhóm theo">
                        <filter string="Loại văn bản" name="group_luong" context="{'group_by': 'luong_van_ban'}"/>
                        <filter string="Trạng thái" name="group_status" context="{'group_by': 'trang_thai'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="action_van_ban_den" model="ir.actions.act_window">
            <field name="name">Văn bản đến</field>
            <field name="res_model">quan_ly_van_ban</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('luong_van_ban', '=', 'den')]</field>
            <field name="context">{'default_luong_van_ban': 'den', 'default_trang_thai': 'tiep_nhan'}</field>
            <field name="search_view_id" ref="view_van_ban_search"/>
            </record>

        <record id="action_van_ban_di" model="ir.actions.act_window">
            <field name="name">Văn bản đi</field>
            <field name="res_model">quan_ly_van_ban</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('luong_van_ban', '=', 'di')]</field>
            <field name="context">{'default_luong_van_ban': 'di', 'default_trang_thai': 'du_thao'}</field>
            <field name="search_view_id" ref="view_van_ban_search"/>
        </record>

        <record id="action_van_ban_noi_bo" model="ir.actions.act_window">
            <field name="name">Văn bản nội bộ</field>
            <field name="res_model">quan_ly_van_ban</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('luong_van_ban', '=', 'noi_bo')]</field>
            <field name="context">{'default_luong_van_ban': 'noi_bo'}</field>
            <field name="search_view_id" ref="view_van_ban_search"/>
        </record>

        <record id="action_quan_ly_van_ban_all" model="ir.actions.act_window">
            <field name="name">Tất cả văn bản</field>
            <field name="res_model">quan_ly_van_ban</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_van_ban_search"/>
        </record>

        <record id="action_van_ban_den_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_van_ban_tree"/>
            <field name="act_window_id" ref="action_van_ban_den"/>
        </record>
        <record id="action_van_ban_den_form" model="ir.actions.act_window.view">
            <field name="sequence" eval="2"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_van_ban_den_form"/>
            <field name="act_window_id" ref="action_van_ban_den"/>
        </record>

        <record id="action_van_ban_di_tree" model="ir.actions.act_window.view">
            <field name="sequence" eval="1"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_van_ban_tree"/>
            <field name="act_window_id" ref="action_van_ban_di"/>
        </record>
        <record id="action_van_ban_di_form" model="ir.actions.act_window.view">
            <field name="sequence" eval="2"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_van_ban_di_form"/>
            <field name="act_window_id" ref="action_van_ban_di"/>
        </record>

        <menuitem id="menu_van_ban_root" name="Quản lý Văn bản" sequence="40"/>
        <menuitem id="menu_quan_ly_so_van_ban" name="Sổ văn bản" parent="menu_van_ban_root" sequence="10"/>
        <menuitem id="menu_so_van_ban_den" name="Văn bản đến" parent="menu_quan_ly_so_van_ban" action="action_van_ban_den" sequence="10"/>
        <menuitem id="menu_so_van_ban_di" name="Văn bản đi" parent="menu_quan_ly_so_van_ban" action="action_van_ban_di" sequence="20"/>
        <menuitem id="menu_so_van_ban_noi_bo" name="Văn bản nội bộ" parent="menu_quan_ly_so_van_ban" action="action_van_ban_noi_bo" sequence="30"/>
        <menuitem id="menu_van_ban_all" name="Tất cả văn bản" parent="menu_van_ban_root" action="action_quan_ly_van_ban_all" sequence="90"/>
    </data>
</odoo>
<!-- <?xml version="1.0" encoding="utf-8"?>
<odoo>
    <menuitem id="menu_van_ban_root" name="Quản lý Văn bản" sequence="40"/>

    <record id="action_van_ban_den" model="ir.actions.act_window">
        <field name="name">Văn bản đến</field>
        <field name="res_model">quan_ly_van_ban</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('luong_van_ban', '=', 'den')]</field>
        <field name="context">{'default_luong_van_ban': 'den'}</field>
    </record>

    <record id="action_van_ban_di" model="ir.actions.act_window">
        <field name="name">Văn bản đi</field>
        <field name="res_model">quan_ly_van_ban</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('luong_van_ban', '=', 'di')]</field>
        <field name="context">{'default_luong_van_ban': 'di'}</field>
    </record>

    <record id="action_van_ban_noi_bo" model="ir.actions.act_window">
        <field name="name">Văn bản nội bộ</field>
        <field name="res_model">quan_ly_van_ban</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('luong_van_ban', '=', 'noi_bo')]</field>
        <field name="context">{'default_luong_van_ban': 'noi_bo'}</field>
    </record>

    <menuitem id="menu_quan_ly_so_van_ban" name="Sổ văn bản" parent="menu_van_ban_root" sequence="10"/>
    
    <menuitem id="menu_so_van_ban_den" name="Văn bản đến" parent="menu_quan_ly_so_van_ban" action="action_van_ban_den" sequence="10"/>
    <menuitem id="menu_so_van_ban_di" name="Văn bản đi" parent="menu_quan_ly_so_van_ban" action="action_van_ban_di" sequence="20"/>
    <menuitem id="menu_so_van_ban_noi_bo" name="Văn bản nội bộ" parent="menu_quan_ly_so_van_ban" action="action_van_ban_noi_bo" sequence="30"/>

    <menuitem id="menu_van_ban_all" name="Tất cả văn bản" parent="menu_van_ban_root" action="action_quan_ly_van_ban" sequence="90"/>
</odoo> -->
